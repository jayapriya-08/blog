---
title: "GitHub Actions: How to Create Pull Requests Automatically"
date: 2019-10-11T19:07:35+09:00
author: Peter Evans
description: "Making pull requests to a GitHub repository automatically with GitHub Actions"
keywords: ["github", "github actions", "workflow", "pull request", "automation", "ci", "bot"]
---

Introducing one of the first GitHub Actions I wrote and [published to the GitHub Marketplace](https://github.com/marketplace/actions/create-pull-request). A generic action to automatically create a pull request for changes to your repository in the Actions workspace.

### create-pull-request

Changes to a repository in the Actions workspace persist between steps in a workflow.
The [create-pull-request](https://github.com/peter-evans/create-pull-request) action is designed to be used in conjunction with other steps that modify or add files to your repository.
The local changes will be automatically committed to a new branch and a pull request created.

Create Pull Request action will:

1. Check for repository changes in the Actions workspace. This includes:
   - untracked (new) files
   - tracked (modified) files
   - commits made during the workflow that have not been pushed
2. Commit all changes to a new branch, or update an existing pull request branch.
3. Create a pull request to merge the new branch into the base&mdash;the branch checked out in the workflow.

There are many interesting use cases for this type of action, such as...

- Process management bots
- Synchronization with external data sources
- Updating contract definitions (API, Swagger docs, etc.)
- Code linting/formatting
- Static analysis/fixes
- Scheduled process management

### Basic example workflow

Here is simple example that adds a dated report to a repository and raises a pull request.

<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">on</span>:
  <span class="pl-ent">schedule</span>:
    - <span class="pl-ent">cron</span>: <span class="pl-s"><span class="pl-pds">'</span>0 10 * * *<span class="pl-pds">'</span></span>
<span class="pl-ent">name</span>: <span class="pl-s">create-pull-request workflow</span>
<span class="pl-ent">jobs</span>:
  <span class="pl-ent">createPullRequest</span>:
    <span class="pl-ent">runs-on</span>: <span class="pl-s">ubuntu-latest</span>
    <span class="pl-ent">steps</span>:
      - <span class="pl-ent">uses</span>: <span class="pl-s">actions/checkout@v2</span>
      - <span class="pl-ent">name</span>: <span class="pl-s">Create report file</span>
        <span class="pl-ent">run</span>: <span class="pl-s">date +%s &gt; report.txt</span>
      - <span class="pl-ent">name</span>: <span class="pl-s">Create Pull Request</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">peter-evans/create-pull-request@v3</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">token</span>: <span class="pl-s">${{ secrets.GITHUB_TOKEN }}</span>
          <span class="pl-ent">commit-message</span>: <span class="pl-s">Add report file</span>
          <span class="pl-ent">title</span>: <span class="pl-s"><span class="pl-pds">'</span>[Example] Add report file<span class="pl-pds">'</span></span>
          <span class="pl-ent">body</span>: <span class="pl-s">&gt;</span>
<span class="pl-s">            This PR is auto-generated by </span>
<span class="pl-s">            [create-pull-request](https://github.com/peter-evans/create-pull-request).</span>
<span class="pl-s"></span>          <span class="pl-ent">labels</span>: <span class="pl-s">report, automated pr</span></pre></div>

This is an example of what pull requests created with the action look like on GitHub.

<img src="/img/pull-request-example.png" alt="Pull Request Example" width="700">

### Example workflow to automate periodic dependency updates

This pattern will work well for updating any kind of static content from an external source.
The following example workflow executes once a week and will create a pull request for any new npm dependency updates. 
It works best in combination with a build workflow triggered on `push` and `pull_request`.
A [Personal Access Token (PAT)](https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line) can be used in order for the creation of the pull request to trigger further workflows. See the [documentation here](https://github.com/peter-evans/create-pull-request/blob/master/docs/concepts-guidelines.md#triggering-further-workflow-runs) for further details.

<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">name</span>: <span class="pl-s">Update Dependencies</span>
<span class="pl-ent">on</span>:
  <span class="pl-ent">schedule</span>:
    - <span class="pl-ent">cron</span>:  <span class="pl-s"><span class="pl-pds">'</span>0 10 * * 1<span class="pl-pds">'</span></span>
<span class="pl-ent">jobs</span>:
  <span class="pl-ent">update-dep</span>:
    <span class="pl-ent">runs-on</span>: <span class="pl-s">ubuntu-latest</span>
    <span class="pl-ent">steps</span>:
      - <span class="pl-ent">uses</span>: <span class="pl-s">actions/checkout@v2</span>
      - <span class="pl-ent">uses</span>: <span class="pl-s">actions/setup-node@v1</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">node-version</span>: <span class="pl-s"><span class="pl-pds">'</span>12.x<span class="pl-pds">'</span></span>
      - <span class="pl-ent">name</span>: <span class="pl-s">Update dependencies</span>
        <span class="pl-ent">run</span>: <span class="pl-s">|</span>
<span class="pl-s">          npx -p npm-check-updates ncu -u</span>
<span class="pl-s">          npm install</span>
<span class="pl-s"></span>      - <span class="pl-ent">name</span>: <span class="pl-s">Create Pull Request</span>
        <span class="pl-ent">uses</span>: <span class="pl-s">peter-evans/create-pull-request@v3</span>
        <span class="pl-ent">with</span>:
            <span class="pl-ent">token</span>: <span class="pl-s">${{ secrets.PAT }}</span>
            <span class="pl-ent">commit-message</span>: <span class="pl-s">Update dependencies</span>
            <span class="pl-ent">title</span>: <span class="pl-s">Update dependencies</span>
            <span class="pl-ent">body</span>: <span class="pl-s">|</span>
<span class="pl-s">              - Dependency updates</span>
<span class="pl-s"></span>  
              <span class="pl-s">Auto-generated by [create-pull-request][1]</span>
  
              <span class="pl-ent">[1]</span>: <span class="pl-s">https://github.com/peter-evans/create-pull-request</span>
            <span class="pl-ent">branch</span>: <span class="pl-s">update-dependencies</span></pre></div>

The above workflow works best in combination with a build workflow triggered on `push` and `pull_request`.

<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">name</span>: <span class="pl-s">CI</span>
<span class="pl-ent">on</span>:
  <span class="pl-ent">push</span>:
    <span class="pl-ent">branches</span>: <span class="pl-s">[master]</span>
  <span class="pl-ent">pull_request</span>:
    <span class="pl-ent">branches</span>: <span class="pl-s">[master]</span>
<span class="pl-ent">jobs</span>:
  <span class="pl-ent">build</span>:
    <span class="pl-ent">runs-on</span>: <span class="pl-s">ubuntu-latest</span>
    <span class="pl-ent">steps</span>:
      - <span class="pl-ent">uses</span>: <span class="pl-s">actions/checkout@v2</span>
      - <span class="pl-ent">uses</span>: <span class="pl-s">actions/setup-node@v1</span>
        <span class="pl-ent">with</span>:
          <span class="pl-ent">node-version</span>: <span class="pl-s">12.x</span>
      - <span class="pl-ent">run</span>: <span class="pl-s">npm ci</span>
      - <span class="pl-ent">run</span>: <span class="pl-s">npm run test</span>
      - <span class="pl-ent">run</span>: <span class="pl-s">npm run build</span></pre></div>

### Further examples and documentation

For further examples of how create-pull-request action can be used, please see the [list of examples](https://github.com/peter-evans/create-pull-request/blob/master/docs/examples.md) in the documentation.

See the [create-pull-request](https://github.com/peter-evans/create-pull-request) action repository for the latest version and full usage details.
